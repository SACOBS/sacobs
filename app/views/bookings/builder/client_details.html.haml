= content_for (:title) do
  Booking Wizard - Choose client

= content_for (:actions) do
  = link_to_if(@booking.has_return?, 'Back', previous_wizard_path, class: t('buttons.inverse')) {}
  = link_to_unless(@booking.has_return?, 'Back', wizard_path(:trip_details), class: t('buttons.inverse')) {}
  = link_to 'Cancel', booking_path(@booking), method: :delete, class: t('buttons.danger')

#errors= errors_for @booking
= simple_form_for @booking,  url: wizard_path, defaults: { error: false }, html: { class: 'form-horizontal', method: :patch } do |f|
  .form-actions
    = f.submit 'Next (alt + n)', class: t('buttons.primary'), accesskey: 'n'
  .search
    %fieldset
      %legend Search for client
      = f.input :client_search, typeahead: clients, label: false, autofocus: true, placeholder: 'Search for client', input_html: { value: '', data: { targets: '#booking_client_attributes_id, #booking_client_id', populate: '.new_client_fields', filter: :full_name } }
      = f.input :client_id, as: :hidden
  .new_client_fields
    = f.simple_fields_for :client, defaults: { label: false } do |client|
      %fieldset
        %legend Or add a new one
        .row
          .span4
            = client.input :title, collection: Client::TITLES, include_blank: true, prompt: 'Select a title'
            = client.input :name, placeholder: 'Name'
            = client.input :surname, placeholder: 'Surname'
            = client.simple_fields_for :address do |address|
              = address.input :city, placeholder: 'City'
            = client.input :id_number, placeholder: 'Id Number'
          .span4
            = client.input :bank, include_blank: true, prompt: 'Select a bank', collection: Client::BANKS
            = client.input :high_risk, label: false, inline_label: true
            = client.input :cell_no, as: :tel, placeholder: 'Cell No'
            = client.input :home_no, as: :tel, placeholder: 'Home No'
            = client.input :work_no, as: :tel, placeholder: 'Work No'
            = client.input :email, as: :email, placeholder: 'Email'
          .span4
            = client.simple_fields_for :address do |address|
              = address.input :street_address1, placeholder: 'Street Address 1'
              = address.input :street_address2, placeholder: 'Street Address 2'
              = address.input :postal_code, placeholder: 'Postal Code'
            = client.input :notes, placeholder: 'Notes'
        = client.hidden_field :user_id, value: current_user.id
        = client.input :id, as: :hidden
