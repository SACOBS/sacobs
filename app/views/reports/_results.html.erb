<div class="well well-small">
  <h3>
    <%= @report.name %>
  </h3>
  <h4>Results Summary</h4>
  <p>Items: <%= @results.size %></p>
  <p>Total Amount: <%= number_to_currency(@results.map(&:price).compact.reduce(&:+)) %></p>
</div>
<div class="results">
  <% @results.group_by { |result| result.updated_at.beginning_of_month }.sort.each do |month, results_per_month| %>
      <h4>
        <%= l(month.to_date, format: :month) %>
      </h4>
      <%= bootstrap_table headers: ['Trip', 'Start Date', 'Status', 'Client', 'Connection', 'Qty', 'Price'], types: [:condensed] do %>
          <% results_per_month.each do |result| %>
              <tr>
                <td>
                  <%= result.trip.name %>
                </td>
                <td>
                  <%= local_date(result.trip.start_date) %>
                </td>
                <td>
                  <%= status_label_for(result) %>
                </td>
                <td>
                  <%= result.client.full_name %>
                </td>
                <td>
                  <%= content_tag(:span, result.stop.name, class: 'label label-inverse') %>
                </td>
                <td>
                  <%= badge_for(result.quantity) %>
                </td>
                <td>
                  <%= number_to_currency(result.invoice.total) %>
                </td>
              </tr>
          <% end %>
      <% end %>
  <% end %>
</div>
